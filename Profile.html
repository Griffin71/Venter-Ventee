<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .profile-container {
            text-align: center;
            padding: 20px;
            background: #f4f4f4;
        }
        .profile-picture {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ddd;
        }
        .post {
            border: 1px solid #ddd;
            margin: 10px auto;
            padding: 10px;
            max-width: 600px;
            background: #fff;
            border-radius: 8px;
        }
        .post-actions {
            margin-top: 10px;
        }
        .post-comments {
            margin-top: 10px;
        }
        .comment {
            margin-bottom: 5px;
        }
        textarea, input[type="file"], button {
            margin-top: 10px;
        }
        .dark-mode {
            background-color: #333;
            color: #fff;
        }
        #postDialog, #settingsModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .modal-content button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="profile-container">
        <img id="profilePicture" class="profile-picture" src="default_profile.png" alt="Profile Picture">
        <br>
        <input type="file" id="profilePictureInput" onchange="uploadProfilePicture()">
        <button onclick="removeProfilePicture()">Remove Profile Picture</button>
        <br>
        <textarea id="bioInput" placeholder="Enter your bio..."></textarea>
        <button onclick="updateBio()">Update Bio</button>
        <p id="bio">No bio available</p>
    </div>

    <div id="postsContainer"></div>

    <div id="postDialog" class="modal-content">
        <textarea id="postText" placeholder="What's on your mind?"></textarea>
        <input type="file" id="postImage">
        <br>
        <button onclick="submitPost()">Post</button>
        <button onclick="closePostDialog()">Cancel</button>
    </div>

    <div id="settingsModal" class="modal-content">
        <button onclick="closeSettings()">Close</button>
        <button onclick="toggleTheme()">Toggle Theme</button>
        <button onclick="showExercises()">Exercises</button>
        <button onclick="showScreenManagement()">Screen Management</button>
    </div>

    <script>
        // Load profile picture and bio from localStorage
        window.onload = function() {
            const profilePicture = localStorage.getItem('profilePicture');
            const bio = localStorage.getItem('bio');
            
            if (profilePicture) {
                document.getElementById('profilePicture').src = profilePicture;
            }
            
            if (bio) {
                document.getElementById('bio').innerText = bio;
            }

            // Load posts
            loadPosts();
        };

        // Upload profile picture
        function uploadProfilePicture() {
            const fileInput = document.getElementById('profilePictureInput');
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const profilePictureUrl = event.target.result;
                    document.getElementById('profilePicture').src = profilePictureUrl;
                    localStorage.setItem('profilePicture', profilePictureUrl);
                };
                reader.readAsDataURL(file);
            }
        }

        // Remove profile picture
        function removeProfilePicture() {
            localStorage.removeItem('profilePicture');
            document.getElementById('profilePicture').src = 'default-profile-picture.png';
        }

        // Update bio
        function updateBio() {
            const bioInput = document.getElementById('bioInput').value.trim();
            if (bioInput) {
                localStorage.setItem('bio', bioInput);
                document.getElementById('bio').innerText = bioInput;
                document.getElementById('bioInput').value = '';
            }
        }

        // Load posts from localStorage
        function loadPosts() {
            const postsContainer = document.getElementById('postsContainer');
            const posts = JSON.parse(localStorage.getItem('userPosts')) || [];
            
            postsContainer.innerHTML = '';
            
            posts.forEach(post => {
                const postElem = document.createElement('div');
                postElem.className = 'post';
                postElem.innerHTML = `
                    <p>${post.description}</p>
                    ${post.image ? `<img src="${post.image}" alt="Post Image" style="max-width: 100%; height: auto;">` : ''}
                    <div class="post-actions">
                        <button onclick="likePost(${post.id})">Love</button>
                        <span>Likes: ${post.likes || 0}</span>
                    </div>
                    <div class="post-comments">
                        ${post.comments ? post.comments.map(comment => `
                            <div class="comment">
                                <span class="user">${comment.username}:</span>
                                <span class="text">${comment.text}</span>
                            </div>
                        `).join('') : ''}
                        <textarea placeholder="Add a comment..." onkeyup="if (event.key === 'Enter') addComment(${post.id}, this)"></textarea>
                    </div>
                `;
                postsContainer.appendChild(postElem);
            });
        }

        // Like a post
        function likePost(postId) {
            const posts = JSON.parse(localStorage.getItem('userPosts')) || [];
            const post = posts.find(p => p.id === postId);
            if (post) {
                post.likes = (post.likes || 0) + 1;
                localStorage.setItem('userPosts', JSON.stringify(posts));
                loadPosts();  // Refresh the posts
            }
        }

        // Add a comment to a post
        function addComment(postId, textarea) {
            const commentText = textarea.value.trim();
            if (commentText) {
                const posts = JSON.parse(localStorage.getItem('userPosts')) || [];
                const post = posts.find(p => p.id === postId);
                if (post) {
                    post.comments = post.comments || [];
                    post.comments.push({
                        username: JSON.parse(localStorage.getItem('userInfo')).username,
                        text: commentText
                    });
                    localStorage.setItem('userPosts', JSON.stringify(posts));
                    textarea.value = '';
                    loadPosts();  // Refresh the posts
                }
            }
        }

        // Open and close post dialog
        function openPostDialog() {
            document.getElementById('postDialog').style.display = 'block';
        }

        function closePostDialog() {
            document.getElementById('postDialog').style.display = 'none';
        }

        // Submit a new post
        function submitPost() {
            const postText = document.getElementById('postText').value.trim();
            const postImage = document.getElementById('postImage').files[0];
            const reader = new FileReader();

            if (postText || postImage) {
                reader.onload = function(event) {
                    const newPost = {
                        id: Date.now(),
                        description: postText,
                        image: event.target.result,
                        likes: 0,
                        comments: []
                    };

                    const posts = JSON.parse(localStorage.getItem('userPosts')) || [];
                    posts.push(newPost);
                    localStorage.setItem('userPosts', JSON.stringify(posts));
                    closePostDialog();
                    loadPosts();  // Refresh the posts
                };

                if (postImage) {
                    reader.readAsDataURL(postImage);
                } else {
                    reader.onload({ target: { result: '' } });
                }
            } else {
                alert('Please enter some text or select an image to post.');
            }
        }

        // Open and close settings modal
        function openSettings() {
            document.getElementById('settingsModal').style.display = 'block';
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // Toggle dark mode
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // Placeholder functions for future implementation
        function showExercises() {
            alert('Exercises functionality to be implemented.');
        }

        function showScreenManagement() {
            alert('Screen management functionality to be implemented.');
        }
    </script>
</body>
</html>

